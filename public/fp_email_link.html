<!DOCTYPE html>
<html>
<head>
<title> HiccApp </title>
<script src="https://www.gstatic.com/firebasejs/4.9.0/firebase.js"></script>
<script>

	// Initialize Firebase
    var config = {
    apiKey: "AIzaSyAG-7U-o1hUOhYbJ2Xox8oEYR-RlsHcMFI",
    authDomain: "hiccapp-official.firebaseapp.com",
    databaseURL: "https://hiccapp-official.firebaseio.com",
    projectId: "hiccapp-official",
    storageBucket: "hiccapp-official.appspot.com",
    messagingSenderId: "447455220269"
    };
    firebase.initializeApp(config);

</script>
<script src="https://www.gstatic.com/firebasejs/4.9.0/firebase-firestore.js"></script>
</head>
<body>

	<img src="https://firebasestorage.googleapis.com/v0/b/hiccapp-official.appspot.com/o/hiccapp_logo.PNG?alt=media&token=c28824d3-3c6c-41be-ac04-f0c2d2f91e3a" style="width:25%; height:50px">
	<div style="margin-top:100px;margin-left:350px; background-color:orange;width:40%; padding:50px">
	<h1 id = "heading"> Identify Yourself! </h1>
	<p id="paragraph" style="display: none;"> </p>
	<form onsubmit="return ValidateForm()">
	<input type="email" name="email" id="email" required> <br>
	<p id="aaa"> Enter your E-mail ID  </p> <br> 
	<input type="text" name="mobno" id="mobno" required> <br>
	<p id ="bbb"> Enter your Mobile Number  </p> <br> 
	<input type="submit" name="submit" id="submit" value="Submit" style="background-color:skyblue"> 
	</form>
	</div>

	<script>

		function ValidateForm() {

			var email = document.getElementById('email').value;
			var mobno = document.getElementById('mobno').value;

			if(mobno.length!=10)
			{
				alert("Mobile Number not valid!");
				return false;
			}
			if(isNaN(mobno)) {
				alert("Invalid Mobile Number!");
				return false;
			}

			var db = firebase.firestore();

			var docRef = db.collection("Users").doc(email);

			docRef.get().then(function(doc) {
			    if (doc.exists) {
			    	if(doc.data().Mobile == mobno) {
			    		if(doc.data().FP_OTP_Verified == false) {
			    			document.getElementById('email').style.display = 'none';
			    			document.getElementById('mobno').style.display = 'none';
			    			document.getElementById('submit').style.display = 'none';
			    			document.getElementById('heading').style.display = 'none';
			    			document.getElementById('aaa').style.display = 'none';
			    			document.getElementById('bbb').style.display = 'none';
			    			document.getElementById('paragraph').style.display = 'block';
			    			document.getElementById('paragraph').innerHTML = "Your OTP is: " + doc.data().FP_OTP;
			    		} else {
			    			document.getElementById('email').style.display = 'none';
			    			document.getElementById('mobno').style.display = 'none';
			    			document.getElementById('submit').style.display = 'none';
			    			document.getElementById('heading').style.display = 'none';
			    			document.getElementById('aaa').style.display = 'none';
			    			document.getElementById('bbb').style.display = 'none';
			    			document.getElementById('paragraph').style.display = 'block';
			    			document.getElementById('paragraph').innerHTML = "Your OTP has already been verified!";
			    		}
			    	} else {
			    		alert("Wrong E-mail ID or Mobile Number!");
			    		document.getElementById('mobno').value = "";
			    		document.getElementById('email').value = "";
			    	}
			    } else {
			        alert("Wrong E-mail ID or Mobile Number!");
			        document.getElementById('mobno').value = "";
			        document.getElementById('email').value = "";
			    }
			}).catch(function(error) {
			    console.log("Error getting document:", error);
			});

			return false;

		}

	</script>

</body>
</html>